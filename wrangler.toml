name = "hamrah-api"
main = "build/worker/shim.mjs"
compatibility_date = "2025-08-22"
compatibility_flags = ["nodejs_compat"]

# Production routes
[[routes]]
pattern = "api.hamrah.app/*"
zone_id = " "

[build]
command = "cargo install -q worker-build && worker-build --release"

[[d1_databases]]
binding = "DB"
database_name = "prod-hamrah-app-auth"
database_id = "aa57b2da-516e-4f48-8595-52ecc887787a"

[build.upload]
dir = "build/worker"
format = "modules"
main = "./shim.mjs"

compatibility_date = "2023-08-01"

[vars]
ENVIRONMENT = "production"

[build]
command = "cargo install -q worker-build && worker-build --release"

[[rules]]
globs = ["**/*.wasm"]
type = "CompiledWasm"

[d1_databases]
DB = { binding = "DB", database_name = "hamrah-db-production", database_id = "c52042c3-9236-4ab6-860b-9b15cf3799cb" }
